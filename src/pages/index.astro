---
import MainLayout from "../layouts/MainLayout.astro";
import Button from "../components/Button.astro";
---

<MainLayout title="Titel">
  <main>
    <!-- HERO -->
    <section class="section pb-0" data-inview="text">
      <div class="container-site">
        <div class="grid-site">
          <!-- LEFT -->
          <div class="pb-10 col-span-6 lg:col-start-1 lg:col-span-7">
            <h1 class="t-h1 pb-4">En stemme, der gør hjemvejen tryg</h1>
            <p class="t-hero max-w-prose">
              Nogle aftener føles vejen hjem længere. Når du ringer eller skriver, er en rolig stemme med dig gennem byen.
            </p>

            <div class="flex gap-4 mt-6">
              <Button size="icon-md" variant="grad1" ariaLabel="Ring til os">
                <img src="/phone.svg" alt="" aria-hidden="true" />
              </Button>

              <Button size="icon-md" variant="grad2" ariaLabel="Chat med os">
                <img src="/Chat.svg" alt="" aria-hidden="true" />
              </Button>
            </div>
          </div>

          <!-- RIGHT -->
          <div class="col-span-full lg:col-start-8 lg:col-span-4 lg:ml-10">
            <div class="star-wrap">
              <!-- Star -->
              <img
                src="/star2.svg"
                alt=""
                aria-hidden="true"
                class="star-bg animate-wiggle animate-infinite animate-duration-[5000ms] animate-ease-linear"
              />

              <!-- Foreground image -->
              <img
                src="/girlonphone.svg"
                alt="Kvinde der taler i telefon"
                class="girl-img"
              />
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- LINE 1 -->
    <section
      class="section relative overflow-hidden pb-0 lg:min-h-[40vh]"
      id="intro-to-not-alone"
      aria-label="Dekorativ linje 1"
    >
      <div class="container-site relative">
        <div class="grid-site">
          <div class="col-span-6 lg:col-start-7 lg:col-span-6">
            <svg
              data-line
              width="259"
              height="319"
              viewBox="0 0 259 319"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
              focusable="false"
            >
              <path
                data-draw="line1"
                d="M241.529 5.00137C262.974 68.0152 269.575 187.725 124.42 162.455C-20.7345 137.185 -3.73351 252.895 22.9113 313.908"
                stroke="#FC7324"
                stroke-width="10"
                stroke-linecap="round"
              />
            </svg>
          </div>
        </div>

        <!-- STAR -->
        <img
          src="/star1.svg"
          alt=""
          aria-hidden="true"
          class="decor-star animate-wiggle animate-infinite animate-duration-[5000ms] animate-ease-linear"
        />
      </div>
    </section>

    <!-- LINE 2 -->
    <section
      class="section py-0 line2-section overflow-hidden"
      id="not-alone-to-arrive"
      aria-label="Du er ikke alene"
    >
      <div class="container-site relative">
        <!-- DECORATIVE LINE -->
        <svg
          data-line
          class="line2 pointer-events-none"
          viewBox="0 0 548 1382"
          preserveAspectRatio="xMidYMid meet"
          fill="none"
          aria-hidden="true"
          focusable="false"
        >
          <path
            data-draw="line2"
            d="M5 5.14394C210.416 9.87286 284.565 -18.6055 327.204 88.8347C374.317 207.553 60.0809 441.262 314.818 498.481C886.756 585.26 186.056 857.582 307.156 1045.85C487.805 1326.7 198.065 1394.94 104.147 1372.27"
            stroke="#FC7324"
            stroke-width="10"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>

        <!-- STAR 6 (desktop only) -->
        <div>
          <img
            src="/star6.svg"
            alt=""
            aria-hidden="true"
            class="hidden lg:block absolute right-[50rem] bottom-[-25rem] lg:w-40 animate-wiggle animate-infinite animate-duration-[5000ms] animate-ease-linear"
          />
        </div>

        <!-- CONTENT -->
        <div class="grid-site relative z-content" data-inview="text">
          <!-- Girl -->
          <div class="col-span-6 min-w-50 lg:col-start-6 lg:col-span-2">
            <img
              src="/girl.svg"
              alt="Pige på vej hjem"
              class="mx-auto w-[260px]"
            />
          </div>

          <!-- Heading -->
          <div class="col-span-6 lg:col-start-4 lg:col-span-6 text-center">
            <h2 class="t-h2">Du er ikke alene</h2>
          </div>

          <!-- Text -->
          <div class="col-start-2 col-span-4 lg:col-start-4 lg:col-span-6 text-center">
            <p class="t-p">
              Ring til os, når du har brug for støtte eller selskab på vejen hjem.
              Vi lytter, beroliger og bliver hos dig, så længe du har brug for det.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- LINE 3 -->
    <section
      class="section lg:pt-0 line3-section overflow-hidden"
      id="arrive-to-next"
      aria-label="Og når du når frem"
    >
      <div class="container-site relative">
        <!-- DECORATIVE LINE -->
        <svg
          data-line
          class="line3 pointer-events-none"
          viewBox="0 0 189 368"
          preserveAspectRatio="xMidYMid meet"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          aria-hidden="true"
          focusable="false"
        >
          <path
            data-draw="line3"
            d="M183.189 5.00018C-2.16264 11.8323 -30.6589 100.932 41.6853 181C93.1865 237.999 -44.3139 307.999 103.187 362.499"
            stroke="#FC7324"
            stroke-width="10"
            stroke-linecap="round"
          />
        </svg>

        <!-- CONTENT -->
        <div class="grid-site relative z-content" data-inview="text">
          <div class="col-start-2 col-span-4 lg:col-start-4 lg:col-span-6 text-center">
            <img src="/girls.svg" alt="" aria-hidden="true" class="mx-auto w-full max-w-md" />

            <h2 class="t-h2 mt-6">Og når du når frem, er vi stadig med dig</h2>

            <p class="t-p mt-4">
              Samtalen stopper, men trygheden følger dig ind ad døren. Du ved, at du
              altid kan ringe igen.
            </p>

            <div class="mt-6">
              <Button variant="grad1" href="tel:+4512345678">+45 12 34 56 78</Button>
            </div>

            <div class="mt-6 flex justify-center gap-4">
              <Button size="icon-md" variant="grad2" ariaLabel="Chat med os" href="/chat">
                <img src="/Chat.svg" alt="" aria-hidden="true" />
              </Button>
            </div>

            <!-- STAR -->
            <div class="mt-6 flex justify-end">
              <img
                src="/star3.svg"
                alt=""
                aria-hidden="true"
                class="w-30 lg:w-40 animate-wiggle animate-infinite animate-duration-[5000ms] animate-ease-linear"
              />
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- INFO CARDS -->
    <section class="section" aria-label="Information" data-inview="text">
      <div class="container-site">
        <div class="grid-site gap-y-6 lg:gap-y-8">
          <!-- Card 1 -->
          <article class="card info-card col-span-6 lg:col-span-6">
            <h3 class="t-h2 info-card__title">Hvem er vi?</h3>
            <p class="t-p info-card__text">
              Vi er et team af engagerede frivillige, der er her for dig, når du har
              brug for selskab på vej hjem.
            </p>
            <div class="info-card__actions">
              <Button variant="grad3" href="/om">Læs mere</Button>
            </div>
          </article>

          <!-- Card 2 -->
          <article class="card info-card col-span-6 lg:col-span-6">
            <h3 class="t-h2 info-card__title">Hvad er vores mission?</h3>
            <p class="t-p info-card__text">
              Vores mission er at gøre hjemvejen mere tryg. Vi vil være der for dig,
              mens du bevæger dig gennem gaderne.
            </p>
            <div class="info-card__actions">
              <Button variant="grad1" href="/om">Læs mere</Button>
            </div>
          </article>

          <!-- Wide Card 3 -->
          <article class="card info-card info-card--wide col-span-6 lg:col-span-12">
            <div class="info-card--wide__content">
              <div>
                <h3 class="t-h2 info-card__title">Vil du støtte os?</h3>
                <p class="t-p info-card__text">
                  Med din støtte kan vi blive ved med at tilbyde en tryg stemme til
                  alle, der har brug for det på hjemvejen.
                </p>
              </div>

              <div class="info-card__actions">
                <Button variant="grad3" href="/stoet">Giv et bidrag</Button>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- VOICE SECTION -->
    <section class="section" aria-label="Bliv frivillig" data-inview="text">
      <div class="container-site">
        <div class="grid-site voice-section">
          <div class="col-span-6 lg:col-start-3 lg:col-span-8 text-center">
            <h2 class="t-h2">Din stemme kan blive nogens sikkerhed</h2>
          </div>

          <div class="col-span-6 lg:col-start-3 lg:col-span-8 flex justify-center">
            <img
              src="/gruppe1.svg"
              alt="Illustration af frivillige"
              class="voice-illustration"
              loading="lazy"
            />
          </div>

          <div class="col-span-6 lg:col-start-3 lg:col-span-8">
            <p class="t-p">
              Som frivillig på vores hotline giver din stemme tryghed og ro til nogen
              på vej hjem. Du lytter og støtter - og for den, der ringer ind, kan det
              betyde alt.
            </p>

            <p class="t-p mt-6">
              Udover det meningsfulde arbejde bliver du en del af et stærkt fællesskab.
              Du kan deltage i sociale arrangementer, workshops og events, hvor vi møder
              folk og spreder budskabet om tryghed på hjemvejen.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- MEET OUR HEROES -->
    <section class="section" aria-label="Mød vores frivillige" data-inview="text">
      <div class="container-site">
        <div class="heroes-layout">
          <!-- CARD -->
          <article class="card heroes-card">
            <h2 class="t-h2">Mød vores heroes</h2>

            <div class="prose-max">
              <p class="t-p mt-4">
                Vores frivillige giver deres tid og omsorg for at gøre hjemvejen tryggere.
                Hver samtale skaber ro og nærvær - ét opkald ad gangen.
              </p>
            </div>

            <div class="heroes-cta mt-6">
              <Button variant="grad3" href="/om">Frivillige</Button>
            </div>
          </article>

          <!-- IMAGES -->
          <div class="heroes-grid">
            <img src="/Person1.webp" alt="" aria-hidden="true" loading="lazy" />
            <img src="/Person2.webp" alt="" aria-hidden="true" loading="lazy" />
            <img src="/Person3.webp" alt="" aria-hidden="true" loading="lazy" />
            <img src="/Person4.webp" alt="" aria-hidden="true" loading="lazy" />
            <img src="/Person5.webp" alt="" aria-hidden="true" loading="lazy" />
            <img src="/Person6.webp" alt="" aria-hidden="true" loading="lazy" />
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // @ts-nocheck
    import { scroll, inView, animate } from "motion";

    const clamp01 = (n) => Math.min(1, Math.max(0, n));

    function drawPathOnSectionScroll(
      sectionSelector,
      pathSelector,
      { offset = ["start 20%", "end 35%"] } = {}
    ) {
      const section = document.querySelector(sectionSelector);
      const path = document.querySelector(pathSelector);
      if (!section || !path) return;

      const length = path.getTotalLength();
      path.style.strokeDasharray = `${length} ${length}`;
      path.style.strokeDashoffset = `${length}`;
      path.style.willChange = "stroke-dashoffset";

      scroll(
        (progress) => {
          const p = clamp01(progress);
          path.style.strokeDashoffset = `${length * (1 - p)}`;
        },
        {
          container: document.documentElement,
          target: section,
          offset,
        }
      );
    }

    function initTextInView() {
      const reduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      if (reduced) return;

      const targets = document.querySelectorAll('[data-inview="text"]');

      targets.forEach((el) => {
        // Prevent double-binding on Astro client-side navigations
        if (el.dataset.inviewReady) return;
        el.dataset.inviewReady = "true";

        // Initial state
        animate(el, { opacity: 0, y: 14 }, { duration: 0 });

        inView(
          el,
          () => {
            // Animate only once
            if (el.dataset.inviewDone) return;
            el.dataset.inviewDone = "true";

            animate(el, { opacity: 1, y: 0 }, { duration: 0.6, easing: "ease-out" });
          },
          { amount: 0.2 }
        );
      });
    }

    const init = () => {
      // Always: text + hover
      initTextInView();

      // Desktop only: decorative line scroll animations
      if (window.innerWidth < 1024) return;

      drawPathOnSectionScroll("#intro-to-not-alone", 'path[data-draw="line1"]');
      drawPathOnSectionScroll("#not-alone-to-arrive", 'path[data-draw="line2"]');
      drawPathOnSectionScroll("#arrive-to-next", 'path[data-draw="line3"]', {
        offset: ["start 40%", "end 100%"],
      });
    };

    document.addEventListener("DOMContentLoaded", init, { once: true });
    document.addEventListener("astro:page-load", init);
  </script>
</MainLayout>
